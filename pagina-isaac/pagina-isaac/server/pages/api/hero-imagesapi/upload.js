"use strict";(()=>{var e={};e.id=652,e.ids=[652],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6705:e=>{e.exports=import("formidable")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,a){return a in r?r[a]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,a)):"function"==typeof r&&"default"===a?r:void 0}}})},2681:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>p,default:()=>u,routeModule:()=>d});var o=a(1802),n=a(7153),i=a(6249),s=a(6724),l=e([s]);s=(l.then?(await l)():l)[0];let u=(0,i.l)(s,"default"),p=(0,i.l)(s,"config"),d=new o.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/hero-imagesapi/upload",pathname:"/api/hero-imagesapi/upload",bundlePath:"",filename:""},userland:s});t()}catch(e){t(e)}})},6724:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>m,default:()=>d});var o=a(3524),n=a(6705),i=a(7147),s=a.n(i),l=a(1017),u=a.n(l),p=e([n]);n=(p.then?(await p)():p)[0];let c=new o.PrismaClient,m={api:{bodyParser:!1}};async function d(e,r){"POST"===e.method?(0,n.default)({uploadDir:u().join(process.cwd(),"public/assets/projects/hero-imagenes"),keepExtensions:!0}).parse(e,async(e,a,t)=>{if(e)return console.error("Error al procesar el formulario:",e),r.status(500).json({error:"Error al procesar el formulario.",values:{files:t.imagen?.[0]}});let o=t.imagen?.[0];if(!o)return r.status(400).json({error:"Imagen no v\xe1lida."});if(!["image/jpeg","image/png"].includes(o.mimetype??""))return r.status(400).json({error:"Tipo de archivo no v\xe1lido. Solo se permiten im\xe1genes."});let n=o.filepath,i=u().join(process.cwd(),"public/assets/projects/hero-imagenes/",o.originalFilename||"imagen_predeterminada.jpg");s().rename(n,i,async e=>{if(e)return console.error("Error al mover la imagen:",e),r.status(500).json({error:"Error al guardar la imagen."});let a="/assets/projects/hero-imagenes/"+(o.originalFilename||"imagen_predeterminada.jpg");try{let e=await c.heroImage.create({data:{imagePath:a}});r.status(201).json(e)}catch(e){console.error("Error al crear la imagen en la base de datos:",e),r.status(500).json({error:"Error al crear la imagen en la base de datos"})}})}):(r.setHeader("Allow",["POST"]),r.status(405).end(`M\xe9todo ${e.method} no permitido`))}t()}catch(e){t(e)}})},7153:(e,r)=>{var a;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,r,a)=>{e.exports=a(145)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var a=r(r.s=2681);module.exports=a})();