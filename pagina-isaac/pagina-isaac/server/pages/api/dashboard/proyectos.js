"use strict";(()=>{var e={};e.id=715,e.ids=[715],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6705:e=>{e.exports=import("formidable")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,o){return o in r?r[o]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,o)):"function"==typeof r&&"default"===o?r:void 0}}})},6345:(e,r,o)=>{o.a(e,async(e,t)=>{try{o.r(r),o.d(r,{config:()=>p,default:()=>c,routeModule:()=>u});var a=o(1802),s=o(7153),n=o(6249),i=o(1027),l=e([i]);i=(l.then?(await l)():l)[0];let c=(0,n.l)(i,"default"),p=(0,n.l)(i,"config"),u=new a.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/dashboard/proyectos",pathname:"/api/dashboard/proyectos",bundlePath:"",filename:""},userland:i});t()}catch(e){t(e)}})},1027:(e,r,o)=>{o.a(e,async(e,t)=>{try{o.r(r),o.d(r,{config:()=>m,default:()=>u});var a=o(3524),s=o(6705),n=o(7147),i=o.n(n),l=o(1017),c=o.n(l),p=e([s]);s=(p.then?(await p)():p)[0];let d=new a.PrismaClient,m={api:{bodyParser:!1}};async function u(e,r){if("POST"===e.method)(0,s.default)({uploadDir:c().join(process.cwd(),"public/assets/projects/proyectos"),keepExtensions:!0}).parse(e,async(e,o,t)=>{if(e)return console.error("Error al procesar el formulario:",e),r.status(500).json({error:"Error al procesar el formulario."});let{nombre:a,activo:s}=o,n=t.imagen?.[0];if(!a||!n||!n)return r.status(400).json({error:"Nombre o imagen no v\xe1lidos.",values:{nombre:a,imagenFile:n}});if(!["image/jpeg","image/png"].includes(n.mimetype??""))return r.status(400).json({error:"Tipo de archivo no v\xe1lido. Solo se permiten im\xe1genes.",values:{imagenFile:n}});let l=n.filepath,p=c().join(process.cwd(),"public/assets/projects/proyectos/",n.originalFilename||"imagen_predeterminada.jpg");i().rename(l,p,async e=>{if(e)return console.error("Error al mover la imagen:",e),r.status(500).json({error:"Error al guardar la imagen."});let o="/assets/projects/proyectos/"+(n.originalFilename||"imagen_predeterminada.jpg");try{let e=await d.proyecto.create({data:{nombre:a[0],imagenUrl:o,isActive:"true"===s[0]}});r.status(201).json(e)}catch(e){console.error("Error al crear el proyecto:",e),r.status(500).json({error:"Error al crear el proyecto"})}})});else if("GET"===e.method)try{let e=await d.proyecto.findMany();r.status(200).json(e)}catch(e){console.error("Error al obtener los proyectos:",e),r.status(500).json({error:"Error al obtener los proyectos"})}else r.setHeader("Allow",["POST","GET"]),r.status(405).end(`M\xe9todo ${e.method} no permitido`)}t()}catch(e){t(e)}})},7153:(e,r)=>{var o;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},1802:(e,r,o)=>{e.exports=o(145)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var o=r(r.s=6345);module.exports=o})();